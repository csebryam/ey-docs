# Caching Strategies

Orchestra Caching of Static Files

Orchestra has two types of caching strategies. We have <a href="#server-caching">server-caching</a> and <a href="#browser-caching">browser-caching</a>. 

# <a name="server-caching"></a>Server Caching
In order to make your applications faster we cache the output of your applications on an caching server. The rules for the caching servers are simple, the output generated by your application will be cached for 10 minutes or until it has been inactive for 5 minutes.

# <a name="browser-caching"></a>Browser Caching
Orchestra honours some strict caching rules for  static files. The browser-caching has been instructed to cache all **static** files for 8 hours. 

In theory, 8 hours of caching is very low and should in fact be much more as they are files unlikely to change. However, as we are aware that many of our users are changing some of those files quite regularly, we've compromised to set the caching of static files to 8 hours.

You can reset the browser-caching by using the `Cache-Control` headers but if the file is still cached on the caching-server, you may not see the modifications right away.

We encourage you to read <a href="#cached-types">the type of cached</a> files so you don't end up wondering why your modifications aren't applied after a deployment.

If it is unacceptable for you to wait 10 minutes before seeing the modified static files like **css**, **javascript**, etc. you can see our <a href="#versioning">versioning</a> section which may help you with your releases.

# <a name="cached-types"></a>Cached Types
When it comes to browser caching, we cache files with the following extensions for 8 hours:

 * jpg, jpeg, png, ico, gif (Images)
 * js (JavaScript files)
 * css (Cascading StyleSheets)
 * txt (Plain Text files)
 * avi, mp3, wave, mpeg, asf, wmv (Media files)

# <a name="clear-cache"></a>Can I clear the cache?
There's no way to currently allow our users to clear the server-cache directly. This would mean that we'd have to virtually allow anyone to purge the cache. However there are solutions for  modifying cached files and you may have encountered those solutions before. <a href="#versioning">Versioning</a> is one of those solutions.

# <a name="versioning"></a>File versioning
Versioning of static files is a good way to bypass the current cache because not only does it allow you to get the files updated with your release but also can help you identify bugs in your application.

By using **versioning** of the static files like css, js, etc., you are able see exactly which release a file is part of and the previous cached files are kept safely  in case they are requested.

We have released part of our versioning system on [github](https://github.com/orchestra-io/versioning). Feel free to fork it, modify it and adapt it to your needs. If you make changes to the code we'd be happy if you contributed them back, if not, well no biggie :)

# <a name="resources"></a>Performance Resources
We follow many rules at Orchestra in terms of server-caching but we also like to help our users make better and faster web-applications. Here are a few links to help you with general frontend performances:

  *  [Put Stylesheets at the Top](http://developer.yahoo.com/performance/rules.html#css_top)
  *  [Put Scripts at the bottom](http://developer.yahoo.com/performance/rules.html#js_bottom)
  *  [Avoid CSS Expressions](http://developer.yahoo.com/performance/rules.html#css_expressions)
  *  [Make JavaScript and CSS External](http://developer.yahoo.com/performance/rules.html#external)
  *  [Minify JavaScript and CSS](http://developer.yahoo.com/performance/rules.html#minify)
  *  [Remove Duplicate Scripts](http://developer.yahoo.com/performance/rules.html#js_dupes)
  *  [Flush the buffer early](http://developer.yahoo.com/performance/rules.html#flush)
  *  [Use GET for Ajax Requests](http://developer.yahoo.com/performance/rules.html#ajax_get)
  *  [Minimize DOM Access](http://developer.yahoo.com/performance/rules.html#dom_access)
  *  [Minimize HTTP Requests](http://developer.yahoo.com/performance/rules.html#num_http)
  *  [No 404](http://developer.yahoo.com/performance/rules.html#no404)
  *  [Reduce number of Iframes](http://developer.yahoo.com/performance/rules.html#iframes)
  *  [Preloading](http://developer.yahoo.com/performance/rules.html#preload)
  *  [Postloading](http://developer.yahoo.com/performance/rules.html#postload)
  *  [High Performance Ajax](http://yuiblog.com/blog/2007/12/20/video-lecomte/)

We also recommend taking a look at [HTML5BoilerPlate](http://html5boilerplate.com/) which is an amazing read for developers interested in making their HTML5 applications fast and future-proof. To quote the html5boiler developers:

> HTML5 Boilerplate is the professional badass's base HTML/CSS/JS template for a fast, robust and future-proof site

Hopefully this will help you achieve better performance thorough your web-applications. If you have any useful resources you'd like to share with us, please let us know and we'll happily add them.


Caching Dirty Secrets
---------------------
So you don't want to cache anything? We don't really know why but you may **really** want to skip the cache so here are a few solutions and ways you can bypass the caches:

  1. Set an **_orchestra** cookie to 1. `setcookie('_orchestra', '1', time()+60*60);`
  2. Set a **_nocache** cookie to 1. `setcookie('_nocache', '1', time()+60*60);`
  3. In your request, pass the query string **_nocache** with the value 1
  
It is not recommended to do this but if you really have to for some of your ajax requests, that's how you could do it.